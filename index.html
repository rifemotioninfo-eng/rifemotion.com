import React, { useState, useEffect, useRef } from 'react';
import { Play, ArrowRight, Mail, Instagram, Linkedin, Dribbble, X, Menu, Maximize2, Minus, Circle, Activity, Clock, ChevronDown } from 'lucide-react';

// --- Custom Hooks & Utils ---

const useOnScreen = (options) => {
  const ref = useRef(null);
  const [isVisible, setIsVisible] = useState(false);

  useEffect(() => {
    const observer = new IntersectionObserver(([entry]) => {
      if (entry.isIntersecting) {
        setIsVisible(true);
        observer.disconnect();
      }
    }, options);

    if (ref.current) {
      observer.observe(ref.current);
    }

    return () => {
      if (ref.current) observer.unobserve(ref.current);
    };
  }, [ref, options]);

  return [ref, isVisible];
};

const Reveal = ({ children, delay = 0, className = "" }) => {
  const [ref, isVisible] = useOnScreen({ threshold: 0.1 });

  return (
    <div
      ref={ref}
      className={`transition-all duration-1000 cubic-bezier(0.16, 1, 0.3, 1) transform ${
        isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-12'
      } ${className}`}
      style={{ transitionDelay: `${delay}ms` }}
    >
      {children}
    </div>
  );
};

// Custom Cursor Component
const CustomCursor = () => {
  const [position, setPosition] = useState({ x: 0, y: 0 });
  const [isHovering, setIsHovering] = useState(false);

  useEffect(() => {
    const onMouseMove = (e) => {
      setPosition({ x: e.clientX, y: e.clientY });
    };
    
    const onMouseOver = (e) => {
      if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON' || e.target.closest('.interactive')) {
        setIsHovering(true);
      } else {
        setIsHovering(false);
      }
    };

    window.addEventListener('mousemove', onMouseMove);
    window.addEventListener('mouseover', onMouseOver);

    return () => {
      window.removeEventListener('mousemove', onMouseMove);
      window.removeEventListener('mouseover', onMouseOver);
    };
  }, []);

  return (
    <div 
      className="fixed pointer-events-none z-[9999] hidden md:block mix-blend-difference"
      style={{ 
        left: position.x, 
        top: position.y,
        transform: `translate(-50%, -50%) scale(${isHovering ? 2.5 : 1})`,
        transition: 'transform 0.2s cubic-bezier(0.16, 1, 0.3, 1)'
      }}
    >
      <div className="w-4 h-4 bg-white rounded-full"></div>
    </div>
  );
};

// --- Components ---

const Navigation = () => {
  const [isOpen, setIsOpen] = useState(false);
  const [time, setTime] = useState('');

  useEffect(() => {
    const updateTime = () => {
      const now = new Date();
      setTime(now.toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' }));
    };
    const interval = setInterval(updateTime, 1000);
    updateTime();
    return () => clearInterval(interval);
  }, []);

  return (
    <nav className="fixed top-0 left-0 w-full bg-[#FEFEFE]/80 backdrop-blur-md z-50 border-b border-[#2B2B2B]/5">
      <div className="max-w-7xl mx-auto px-6 h-24 flex items-center justify-between">
        
        <a href="#" className="interactive group flex items-center gap-2">
          <div className="w-8 h-8 bg-[#F25C19] rounded-full flex items-center justify-center text-white font-bold text-xs overflow-hidden relative">
            <div className="absolute inset-0 bg-black opacity-0 group-hover:opacity-10 transition-opacity"></div>
            R
          </div>
          <span className="font-bold text-xl tracking-tighter text-[#2B2B2B]">
            RIFEMOTION
          </span>
        </a>

        {/* Desktop Menu */}
        <div className="hidden md:flex items-center gap-12">
          <div className="flex gap-8 text-xs font-medium tracking-widest uppercase text-[#4E4E4E] font-mono">
            {['Work', 'Services', 'About', 'Contact'].map((link) => (
              <a 
                key={link} 
                href={`#${link.toLowerCase()}`}
                className="interactive hover:text-[#F25C19] transition-colors duration-300 flex flex-col items-center group"
              >
                {link}
                <span className="w-1 h-1 rounded-full bg-[#F25C19] opacity-0 translate-y-2 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300 mt-1"></span>
              </a>
            ))}
          </div>
          
          <div className="w-px h-8 bg-[#D3D0CB]"></div>
          
          <div className="flex items-center gap-2 text-[#F25C19] font-mono text-xs">
            <Activity size={14} />
            <span>REC {time}</span>
          </div>
        </div>

        {/* Mobile Menu Button */}
        <button className="md:hidden text-[#2B2B2B]" onClick={() => setIsOpen(!isOpen)}>
          {isOpen ? <X size={24} /> : <Menu size={24} />}
        </button>

        {/* Mobile Dropdown */}
        {isOpen && (
          <div className="absolute top-24 left-0 w-full bg-[#FEFEFE] border-b border-[#D3D0CB] p-6 flex flex-col gap-4 md:hidden shadow-xl">
            {['Work', 'Services', 'About', 'Contact'].map((link) => (
              <a 
                key={link} 
                href={`#${link.toLowerCase()}`}
                className="text-2xl font-bold text-[#2B2B2B] hover:text-[#F25C19]"
                onClick={() => setIsOpen(false)}
              >
                {link}
              </a>
            ))}
          </div>
        )}
      </div>
    </nav>
  );
};

const Hero = () => {
  return (
    <section className="pt-40 pb-20 px-6 min-h-screen flex flex-col justify-center max-w-7xl mx-auto relative overflow-hidden">
      
      {/* Abstract UI Decoration - Timeline */}
      <div className="absolute left-6 bottom-10 hidden lg:flex flex-col gap-2 w-64 opacity-30 pointer-events-none">
        <div className="flex justify-between text-[10px] font-mono text-[#2B2B2B]">
            <span>00:00</span><span>00:15</span><span>00:30</span>
        </div>
        <div className="h-12 border border-[#2B2B2B]/20 rounded relative bg-[#FAFAF9]">
            <div className="absolute top-0 left-[20%] w-[40%] h-full bg-[#F25C19]/20 border-l border-r border-[#F25C19]/40"></div>
            <div className="absolute top-0 left-[45%] h-full w-px bg-[#F25C19]"></div>
        </div>
        <div className="h-2 w-full bg-[#2B2B2B]/10 rounded-full overflow-hidden">
            <div className="h-full w-[45%] bg-[#2B2B2B]"></div>
        </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 items-center">
        <div className="lg:col-span-8 z-10">
          <Reveal>
            <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-[#F25C19] text-[#F25C19] font-mono text-xs font-medium tracking-wider mb-8 bg-[#F25C19]/5">
              <span className="relative flex h-2 w-2">
                <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-[#F25C19] opacity-75"></span>
                <span className="relative inline-flex rounded-full h-2 w-2 bg-[#F25C19]"></span>
              </span>
              AVAILABLE FOR FREELANCE
            </div>
          </Reveal>
          <Reveal delay={100}>
            <h1 className="text-6xl md:text-8xl font-bold text-[#2B2B2B] leading-[0.9] tracking-tight mb-8">
              DIGITAL <br />
              <span className="italic font-serif font-light text-[#4E4E4E]">KINETICS</span> & <br />
              MOTION
            </h1>
          </Reveal>
          <Reveal delay={200}>
            <p className="text-[#4E4E4E] max-w-lg text-lg leading-relaxed mb-10 font-light border-l-2 border-[#F25C19] pl-6">
              Refining brands through precise movement. <br/>
              Specializing in 2D motion, typography, and interface behaviors.
            </p>
          </Reveal>
          <Reveal delay={300}>
            <div className="flex items-center gap-6">
                <button className="interactive bg-[#2B2B2B] text-white px-8 py-4 rounded font-medium hover:bg-[#F25C19] transition-all duration-300 flex items-center gap-3 shadow-xl shadow-[#2B2B2B]/20 hover:shadow-[#F25C19]/30 group">
                    <Play size={16} fill="currentColor" />
                    <span>WATCH REEL</span>
                </button>
                <a href="#work" className="interactive font-mono text-xs text-[#4E4E4E] hover:text-[#2B2B2B] border-b border-transparent hover:border-[#2B2B2B] transition-all">
                    SCROLL TO EXPLORE ↓
                </a>
            </div>
          </Reveal>
        </div>

        {/* Hero Visual - "Bezier Curve Tool" */}
        <div className="hidden lg:block lg:col-span-4 relative h-96 w-full">
            <Reveal delay={400}>
                <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full h-full border border-[#D3D0CB] bg-[#FAFAF9] rounded-lg shadow-2xl p-4">
                    {/* Fake Window Header */}
                    <div className="flex justify-between items-center border-b border-[#D3D0CB] pb-2 mb-4">
                        <div className="flex gap-2">
                            <div className="w-3 h-3 rounded-full bg-[#D3D0CB]"></div>
                            <div className="w-3 h-3 rounded-full bg-[#D3D0CB]"></div>
                        </div>
                        <div className="text-[10px] font-mono text-[#4E4E4E] uppercase">Ease_Out.jsx</div>
                    </div>
                    {/* The Curve */}
                    <div className="relative h-64 w-full bg-white border border-[#D3D0CB]/30 overflow-hidden grid grid-cols-6 grid-rows-6 gap-px">
                        {/* Grid lines */}
                        {[...Array(7)].map((_, i) => (
                             <div key={i} className="absolute left-0 w-full h-px bg-[#F2F2F2] top-[16.6%]" style={{top: `${i * 16.6}%`}}></div>
                        ))}
                        {[...Array(7)].map((_, i) => (
                             <div key={i} className="absolute top-0 h-full w-px bg-[#F2F2F2]" style={{left: `${i * 16.6}%`}}></div>
                        ))}
                        
                        {/* Bezier Curve SVG */}
                        <svg viewBox="0 0 100 100" className="absolute inset-0 w-full h-full overflow-visible" preserveAspectRatio="none">
                            <path d="M0,100 C50,100 20,0 100,0" fill="none" stroke="#F25C19" strokeWidth="1" />
                            {/* Control Handles */}
                            <line x1="0" y1="100" x2="50" y2="100" stroke="#2B2B2B" strokeWidth="0.5" strokeDasharray="2,2" />
                            <circle cx="50" cy="100" r="2" fill="#2B2B2B" />
                            
                            <line x1="100" y1="0" x2="20" y2="0" stroke="#2B2B2B" strokeWidth="0.5" strokeDasharray="2,2" />
                            <circle cx="20" cy="0" r="2" fill="#2B2B2B" />
                            
                            {/* Animated Dot */}
                            <circle r="3" fill="#F25C19">
                                <animateMotion 
                                    dur="2s" 
                                    repeatCount="indefinite"
                                    path="M0,100 C50,100 20,0 100,0"
                                    calcMode="spline"
                                    keySplines="0.5 0 0.5 1"
                                />
                            </circle>
                        </svg>
                    </div>
                </div>
            </Reveal>
        </div>
      </div>
    </section>
  );
};

const ProjectWindow = ({ title, category, year, color, index }) => {
  return (
    <div className="interactive group mb-12">
      <div className="flex justify-between items-end mb-3 px-1">
        <div>
            <h3 className="text-2xl font-bold text-[#2B2B2B] group-hover:text-[#F25C19] transition-colors">{title}</h3>
            <div className="flex gap-2 text-xs font-mono text-[#4E4E4E] mt-1">
                <span className="bg-[#F2F2F2] px-1 rounded text-[#2B2B2B] border border-[#D3D0CB]">1920x1080</span>
                <span>// {category}</span>
            </div>
        </div>
        <span className="font-mono text-xs text-[#D3D0CB]">0{index + 1}</span>
      </div>
      
      {/* Window Frame Style Card */}
      <div className="relative bg-white rounded-lg border border-[#D3D0CB] shadow-sm group-hover:shadow-xl group-hover:shadow-[#F25C19]/10 transition-all duration-500 overflow-hidden">
        {/* Window Header */}
        <div className="h-8 bg-[#FAFAF9] border-b border-[#D3D0CB] flex items-center px-3 justify-between">
             <div className="flex gap-1.5">
                <div className="w-2.5 h-2.5 rounded-full bg-[#D3D0CB] group-hover:bg-[#F25C19] transition-colors"></div>
                <div className="w-2.5 h-2.5 rounded-full bg-[#D3D0CB]"></div>
                <div className="w-2.5 h-2.5 rounded-full bg-[#D3D0CB]"></div>
             </div>
             <div className="text-[9px] font-mono text-[#4E4E4E] opacity-50 uppercase tracking-widest">{title}.mp4</div>
        </div>

        {/* Content/Thumbnail */}
        <div className="relative aspect-video overflow-hidden bg-[#E5E5E5]">
            <div className={`absolute inset-0 ${color} opacity-20 mix-blend-multiply`}></div>
            
            {/* Hover overlay */}
            <div className="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black/10 backdrop-blur-[2px]">
                <div className="bg-white/90 text-[#2B2B2B] px-6 py-2 rounded-full font-mono text-xs font-bold tracking-widest uppercase flex items-center gap-2 transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                    <Play size={10} fill="currentColor" /> Play Preview
                </div>
            </div>
            
            {/* Abstract content simulation */}
            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1/2 h-1/2 border-2 border-[#2B2B2B]/10 rotate-45 group-hover:rotate-90 transition-transform duration-700 ease-out"></div>
            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1/3 h-1/3 bg-[#F25C19] rounded-full opacity-0 group-hover:opacity-20 scale-0 group-hover:scale-150 transition-all duration-500"></div>
        </div>
        
        {/* Footer Info */}
        <div className="px-4 py-2 flex justify-between text-[10px] font-mono text-[#4E4E4E] bg-[#FAFAF9] border-t border-[#D3D0CB]">
            <span>Render: Cycles</span>
            <span>{year}</span>
        </div>
      </div>
    </div>
  );
};

const Works = () => {
  const projects = [
    { title: "Vortex Identity", category: "Branding", year: "2024", color: "bg-slate-500" },
    { title: "Nike Air Max", category: "Commercial", year: "2023", color: "bg-orange-500" },
    { title: "Future Interface", category: "UI/UX Motion", year: "2023", color: "bg-emerald-500" },
    { title: "Kinetic Type", category: "Experimental", year: "2024", color: "bg-indigo-500" },
  ];

  return (
    <section className="py-32 px-6 bg-[#FAFAF9]" id="work">
      <div className="max-w-7xl mx-auto">
        <Reveal>
          <div className="flex flex-col md:flex-row justify-between items-end mb-20 pb-6 border-b border-[#D3D0CB]">
            <div>
                <div className="text-[#F25C19] font-mono text-xs mb-2">SELECTED WORKS (04)</div>
                <h2 className="text-4xl font-bold text-[#2B2B2B]">FEATURED PROJECTS</h2>
            </div>
            <button className="interactive flex items-center gap-2 text-sm font-bold uppercase tracking-widest text-[#2B2B2B] hover:text-[#F25C19] transition-colors mt-6 md:mt-0">
              View Archive <ArrowRight size={16} />
            </button>
          </div>
        </Reveal>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8">
          {projects.map((p, i) => (
            <Reveal key={i} delay={i * 100} className={i % 2 !== 0 ? "md:mt-20" : ""}>
              <ProjectWindow {...p} index={i} />
            </Reveal>
          ))}
        </div>
      </div>
    </section>
  );
};

const Services = () => {
  const services = [
    { id: "01", title: "Motion Branding", desc: "Logo animation, bumpers, and dynamic identity systems that live on screens." },
    { id: "02", title: "UI Interactions", desc: "Prototyping micro-interactions and interface behaviors for apps and web." },
    { id: "03", title: "2D Animation", desc: "Explainer videos and character animation with a focus on clean geometry." },
    { id: "04", title: "Art Direction", desc: "Visual style development and storyboarding for complex campaigns." },
  ];

  return (
    <section className="py-32 px-6 bg-[#2B2B2B] text-[#FEFEFE]" id="services">
      <div className="max-w-7xl mx-auto">
        <Reveal>
            <div className="flex items-center gap-4 mb-16 opacity-50">
                <Activity size={20} className="text-[#F25C19]" />
                <h2 className="font-mono text-sm tracking-widest uppercase">Capabilities & Stack</h2>
            </div>
        </Reveal>

        <div className="grid grid-cols-1 lg:grid-cols-12 gap-16">
            <div className="lg:col-span-4">
                <Reveal>
                    <h3 className="text-3xl font-bold leading-tight mb-6">
                        Bridging the gap between <span className="text-[#F25C19]">design</span> and <span className="italic font-serif font-light opacity-70">execution</span>.
                    </h3>
                    <p className="text-[#D3D0CB]/60 text-sm leading-relaxed mb-8">
                        Using a software-agnostic approach to solve visual problems. Whether it's After Effects, Cinema 4D, or Rive - the tool matters less than the feeling.
                    </p>
                    
                    {/* "Stack" list looking like tags */}
                    <div className="flex flex-wrap gap-2">
                        {['After Effects', 'Figma', 'C4D', 'Redshift', 'Rive', 'Spline'].map(tool => (
                            <span key={tool} className="px-3 py-1 border border-[#D3D0CB]/20 rounded-full text-[10px] font-mono text-[#D3D0CB] hover:border-[#F25C19] hover:text-[#F25C19] transition-colors cursor-default">
                                {tool}
                            </span>
                        ))}
                    </div>
                </Reveal>
            </div>

            <div className="lg:col-span-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                {services.map((s, i) => (
                    <Reveal key={i} delay={i * 100}>
                        <div className="interactive p-8 bg-[#333333] hover:bg-[#383838] transition-colors rounded-lg border border-[#444444] hover:border-[#F25C19]/50 group h-full flex flex-col justify-between">
                            <div>
                                <div className="font-mono text-[#F25C19] text-xs mb-4 opacity-0 -translate-y-2 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300">
                                    // MODULE {s.id}
                                </div>
                                <h4 className="text-xl font-bold mb-3">{s.title}</h4>
                                <p className="text-sm text-[#D3D0CB]/60 leading-relaxed">{s.desc}</p>
                            </div>
                            <div className="w-full h-px bg-[#444444] mt-8 group-hover:bg-[#F25C19] transition-colors relative overflow-hidden">
                                <div className="absolute top-0 left-0 h-full w-full bg-[#F25C19] transform -translate-x-full group-hover:translate-x-0 transition-transform duration-500"></div>
                            </div>
                        </div>
                    </Reveal>
                ))}
            </div>
        </div>
      </div>
    </section>
  );
};

const Footer = () => {
  return (
    <footer className="bg-[#FEFEFE] pt-24 pb-12 px-6 border-t border-[#D3D0CB]" id="contact">
      <div className="max-w-7xl mx-auto">
        <Reveal>
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start mb-24">
                <div>
                    <h2 className="text-5xl md:text-7xl font-bold text-[#2B2B2B] tracking-tight leading-[0.9]">
                        LET'S START <br/>
                        <span className="text-[#F25C19]">PROJECT.</span>
                    </h2>
                </div>
                <div className="flex flex-col gap-8 lg:items-end">
                    <p className="text-[#4E4E4E] max-w-sm lg:text-right">
                        Currently available for freelance projects and open to full-time opportunities.
                    </p>
                    <a 
                        href="mailto:hello@rifemotion.com" 
                        className="interactive text-2xl md:text-3xl font-bold text-[#2B2B2B] hover:text-[#F25C19] transition-colors underline decoration-[#D3D0CB] underline-offset-8 hover:decoration-[#F25C19]"
                    >
                        hello@rifemotion.com
                    </a>
                </div>
            </div>
        </Reveal>

        <div className="flex flex-col md:flex-row justify-between items-end pt-12 border-t border-[#D3D0CB]/30">
            <div className="flex flex-col gap-4">
                 {/* Social Links */}
                 <div className="flex gap-4">
                    {[<Instagram />, <Linkedin />, <Dribbble />].map((icon, i) => (
                        <a key={i} href="#" className="interactive w-10 h-10 border border-[#D3D0CB] rounded-full flex items-center justify-center text-[#2B2B2B] hover:bg-[#2B2B2B] hover:text-white transition-all duration-300">
                            {React.cloneElement(icon, { size: 18 })}
                        </a>
                    ))}
                </div>
            </div>
            
            <div className="text-right mt-8 md:mt-0">
                <div className="font-mono text-xs text-[#D3D0CB] mb-1">RIFEMOTION © 2025</div>
                <div className="font-mono text-[10px] text-[#D3D0CB]/60">DESIGNED & CODED</div>
            </div>
        </div>
      </div>
    </footer>
  );
};

const App = () => {
  return (
    <div className="min-h-screen bg-[#FEFEFE] text-[#2B2B2B] font-sans selection:bg-[#F25C19] selection:text-white cursor-none">
      <CustomCursor />
      <Navigation />
      <main>
        <Hero />
        {/* Rolling Text / Divider */}
        <div className="border-y border-[#D3D0CB] bg-[#FAFAF9] py-4 overflow-hidden">
             <div className="flex gap-8 animate-marquee whitespace-nowrap font-mono text-xs text-[#F25C19] tracking-[0.2em]">
                {[...Array(10)].map((_, i) => (
                    <React.Fragment key={i}>
                        <span>/// MOTION DESIGN</span>
                        <span className="text-[#2B2B2B]">ART DIRECTION</span>
                        <span>UI ANIMATION</span>
                        <span className="w-2 h-2 bg-[#2B2B2B] rounded-full"></span>
                    </React.Fragment>
                ))}
             </div>
        </div>
        <Works />
        <Services />
      </main>
      <Footer />

      <style>{`
        @keyframes marquee {
          0% { transform: translateX(0); }
          100% { transform: translateX(-50%); }
        }
        .animate-marquee {
          animation: marquee 30s linear infinite;
        }
        /* Hide default cursor only on large screens where custom cursor is active */
        @media (min-width: 768px) {
            body {
                cursor: none;
            }
        }
      `}</style>
    </div>
  );
};

export default App;
